{
    "contents" : "library(ggplot2)\nlibrary(reshape2)\nlibrary(plyr)\nlibrary(zoo)\n\nrm(list =ls(all=TRUE))\nRawData <- read.csv(\"EMD_analysis.csv\", header=TRUE)\n\nhead(RawData)\napply(RawData[c(\"JP_LCEMD\", \"SH_LCEMD\", \"JP_EMD\", \"SH_EMD\")], 2, function(x) sd(x, na.rm=TRUE)*sqrt(12))\n\nRollingObs <- 20\n\nRollSd <- data.frame(cbind(RawData$Date, \n                           rollapplyr(RawData[c(\"JP_LCEMD\", \n                                                \"SH_LCEMD\", \n                                                \"JP_EMD\", \n                                                \"SH_EMD\", \n                                                \"B_LCEMD\", \n                                                \"B_EMD\")], \n                                      RollingObs, sd, fill=NA)))\ncolnames(RollSd)[1] <- \"Date\"\n\nhead(RollSd)\nRollSd$Date <- as.Date(RollSd$Date)\n\nmeltdf<-melt(RollSd,id=\"Date\")\nggplot(na.omit(meltdf), \n       aes(x=Date, y=value, colour=variable, group=variable, linetype = variable, size= variable)) +\n  geom_line() + \n  ylab(paste0(\"Rolling sd (\", toString(RollingObs), \"obs)\")) + \n  scale_linetype_manual(values= c(\"solid\",\"dashed\",\"solid\",\"dashed\", \"dotted\", \"dotted\")) +\n  scale_color_manual(values= c(\"purple\", \"purple\", \"orange\", \"orange\", \"purple\", \"orange\")) + \n  scale_size_manual(values= c(1.1, 1.1, 1.1, 1.1, 1, 1)) + \n  theme(legend.position=\"bottom\")\n\n\nRawData$Date <- as.Date(RawData$Date, format=\"%d/%m/%Y\")\nRawData$SH_EMDr <- RawData$SH_EMD - RawData$B_EMD\nRawData$SH_LEMDr <- RawData$SH_LCEMD - RawData$B_LCEMD\nRawData$JP_EMDr <- RawData$JP_EMD - RawData$B_EMD\nRawData$JP_LEMDr <- RawData$JP_LCEMD - RawData$B_LCEMD\n\nhead(RawData)\n\nEMDset <- subset(RawData, !is.na(SH_EMD) | !is.na(JP_EMD), select=c(Date, SH_EMD, JP_EMD, B_EMD))\nLEMDset <- subset(RawData, !is.na(SH_LCEMD) | !is.na(JP_LCEMD), select=c(Date, SH_LCEMD, JP_LCEMD, B_LCEMD))\nEMDrr <- subset(RawData, !is.na(SH_EMD) | !is.na(JP_EMD), select=c(Date, SH_EMDr, JP_EMDr))\nLEMDrr <- subset(RawData, !is.na(SH_LCEMD) | !is.na(JP_LCEMD), select=c(Date, SH_LEMDr, JP_LEMDr))\n\nW_JP_LCEMD <- data.frame(W_JP_LCEMD=RawData$B_LCEMD[!is.na(RawData$JP_LCEMD)])\nW_SH_LCEMD <- data.frame(W_SH_LCEMD=RawData$B_LCEMD[!is.na(RawData$SH_LCEMD)])\nW_JP_EMD <- data.frame(W_JP_EMD=RawData$B_EMD[!is.na(RawData$JP_EMD)])\nW_SH_EMD <- data.frame(W_SH_EMD=RawData$B_EMD[!is.na(RawData$SH_EMD)])\n\nWORLDS <- do.call(rbind.fill, list(W_JP_LCEMD, W_SH_LCEMD, W_JP_EMD, W_SH_EMD))\napply(WORLDS, 2, function(x) sd(x, na.rm=TRUE)*sqrt(12))\nrm(list =ls(pattern=\"W_\"))\n\nmeltdf<-melt(EMDset,id=\"Date\")\nggplot(meltdf, \n        aes(x=Date, y=value, colour=variable, group=variable)) +\n        geom_line() + \n        ylab(\"Absolute Returns\") + \n        theme(legend.position=\"bottom\")\n\n\nmeltdf<-melt(LEMDset,id=\"Date\")\nggplot(meltdf, \n      aes(x=Date, y=value, colour=variable, group=variable)) +\n      geom_line() + \n      ylab(\"Absolute Returns\") + \n      theme(legend.position=\"bottom\")\n\nmeltdf<-melt(EMDrr,id=\"Date\")\nggplot(meltdf, \n       aes(x=Date, y=value, colour=variable, group=variable)) +\n  geom_line() + \n  ylab(\"Relative Returns\") + \n  theme(legend.position=\"bottom\")\n\nmeltdf<-melt(LEMDrr,id=\"Date\")\nggplot(meltdf, \n       aes(x=Date, y=value, colour=variable, group=variable)) +\n  geom_line() + \n  ylab(\"Relative Returns\") + \n  theme(legend.position=\"bottom\")\n\nLEMDrr <- subset(RawData, !is.na(SH_LCEMD) & !is.na(JP_LCEMD), select=c(Date, SH_LEMDr, JP_LEMDr))\nmeltdf<-melt(LEMDrr,id=\"Date\")\nggplot(meltdf, \n       aes(x=Date, y=value, colour=variable, group=variable)) +\n  geom_line() + \n  ylab(\"Relative Returns\") + \n  theme(legend.position=\"bottom\")\n\nhead(EMDrr)\nks.test(EMDrr$SH_EMDr, EMDrr$JP_EMDr, alternative=\"two.sided\", exact=NULL)\n\nLEMDrr <- subset(RawData, !is.na(SH_LCEMD) | !is.na(JP_LCEMD), select=c(Date, SH_LEMDr, JP_LEMDr))\nhead(LEMDrr)\nks.test(LEMDrr$SH_LEMDr, LEMDrr$JP_LEMDr, alternative=\"two.sided\", exact=NULL)\n\nSH <- na.omit(EMDrr$SH_EMDr)\nJP <- na.omit(EMDrr$JP_EMDr)\n\nplot(ecdf(SH), \n     xlim=range(c(SH, JP)))\nplot(ecdf(JP), add=TRUE, lty=\"dashed\")\n\nSH <- SH[SH >-5]\n#get rid of 10/09 observation\n\n#ddply(RawData, c(\"JP_LCEMD\", \"JP_EMD\", \"SH_LCEMD\", \"SH_EMD\"), summarize, sd=sd(value), sda=sd(value)*sqrt(12))\n\n",
    "created" : 1425988209461.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2606212150",
    "id" : "D4B6F691",
    "lastKnownWriteTime" : 1426513471,
    "path" : "G:/GitHub/EMD_analysis/Script1.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}